/*
 * CLK.c
 *
 *  Created on: Sep 24, 2013
 *      Author: B46911
 */

#include "CLK.h"
/**********************************************************************************************
* External objects
**********************************************************************************************/


/**********************************************************************************************
* Global variables
**********************************************************************************************/


/**********************************************************************************************
* Constants and macros
**********************************************************************************************/


/**********************************************************************************************
* Local types
**********************************************************************************************/


/**********************************************************************************************
* Local function prototypes
*********************************************************************************************/


/**********************************************************************************************
* Local variables
**********************************************************************************************/


/**********************************************************************************************
* Local functions
**********************************************************************************************/


/**********************************************************************************************
* Global functions
**********************************************************************************************/

/***********************************************************************************************
*
* @brief    CLK_Init - Initialize Core Clock to 40MHz, Bus Clock to 20MHz
* @param    none
* @return   none
*
************************************************************************************************/  
void Clk_Init()
{
 ICS_C1|=ICS_C1_IRCLKEN_MASK;       /* Enable the internal reference clock*/
 ICS_C3= 0x90;                      /* Reference clock frequency = 31.25 kHz*/
 while(!(ICS_S & ICS_S_LOCK_MASK)); /* Wait for PLL, running at 40 MHz (1280 * 31.25 kHz) */
 ICS_C2|=ICS_C2_BDIV(1);	        /* BDIV=2, Bus clock = 20 MHz*/
 ICS_S |= ICS_S_LOLS_MASK;   		/* Clear Loss of lock sticky bit */
}
